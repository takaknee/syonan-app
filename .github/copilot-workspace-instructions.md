# GitHub Copilot Workspace Instructions

これは **syonan-app**（算数れんしゅう）の開発にGitHub Copilotを効果的に活用するための包括的な指示書です。

## プロジェクト概要

**syonan-app**は娘のために開発されている教育的なFlutterモバイルアプリケーションです。算数の練習を楽しく、安全に行えるように設計されています。

### 重要な特徴
- **対象年齢**: 3歳〜12歳の子供
- **言語**: 日本語ファースト
- **プラットフォーム**: Flutter 3.x (iOS/Android/Web対応)
- **設計哲学**: 安全性、教育的価値、アクセシビリティ

## Copilot使用時の基本原則

### 1. 子供の安全とプライバシーを最優先
```dart
// 常にこの観点で考える:
// - 個人情報は収集しない
// - COPPA（米国児童オンラインプライバシー保護法）準拠
// - 適切なコンテンツフィルタリング
// - 保護者の同意システム
```

### 2. 日本語でのコミュニケーション
- **コメント**: 日本語で詳細に説明
- **変数・関数名**: 英語（国際標準）
- **UI文言**: 日本語
- **エラーメッセージ**: 子供にも分かりやすい日本語

### 3. Material Design 3の活用
```dart
// 推奨パターン:
// - NavigationBar, NavigationRail
// - FilledButton, OutlinedButton  
// - Card with Material 3 styling
// - Dynamic Color support
```

## 効果的なプロンプト作成ガイド

### 基本テンプレート
```dart
// TODO: [機能名]を実装
// 目的: [具体的な目的や解決したい問題]
// 要件:
// - [要件1: 具体的で測定可能]
// - [要件2: ユーザビリティ関連]
// - [要件3: パフォーマンス関連]
// 制約:
// - 子供向けアプリの安全性基準遵守
// - Material Design 3準拠
// - アクセシビリティ対応必須
// - const constructorの使用
// セキュリティ:
// - [特定のセキュリティ考慮事項]
// テスト:
// - [必要なテストの種類と観点]

@copilot [具体的な依頼内容を日本語で記述]
```

### コンテキスト提供の重要性
```dart
// 良い例:
// この関数は3歳の子供が算数問題を解く際に使用されます。
// 間違いを恐れずに挑戦できるよう、励ましのメッセージと
// 適切なヒント機能を含める必要があります。
// パフォーマンス要件: 応答時間100ms以内

// 悪い例:
// 算数の関数を作って
```

## アーキテクチャパターン

### 推奨パターン
1. **Repository Pattern**: データアクセスの抽象化
2. **Provider/Riverpod**: 状態管理
3. **Service Layer**: ビジネスロジックの分離
4. **Immutable Data Classes**: データの整合性保証

### ファイル構造
```
lib/
├── main.dart                 # アプリエントリーポイント
├── app/                      # アプリ設定・ルーティング
├── screens/                  # 画面ウィジェット
├── widgets/                  # 共通ウィジェット
├── models/                   # データモデル
├── services/                 # ビジネスロジック
├── repositories/             # データアクセス層
├── providers/                # 状態管理
├── utils/                    # ユーティリティ
├── constants/                # 定数定義
└── l10n/                     # 国際化
```

## コード生成のベストプラクティス

### ウィジェット作成
```dart
// Copilotに依頼する際の理想的な形:
@copilot 子供向けの数字入力ウィジェットを作成してください。
要件:
- 大きなタッチターゲット（最小44px）
- 視覚的フィードバック（押下時のアニメーション）
- 音声読み上げ対応（Semanticsウィジェット使用）
- 誤入力防止（確認ダイアログ）
- 0-9の数字のみ入力可能
- const constructor使用
- Material 3のスタイリング
制約:
- 3歳児でも直感的に操作可能
- 色覚異常への配慮（色以外の視覚的手がかり）
- 60FPS維持
```

### サービス層の実装
```dart
// セキュアなサービス実装の依頼例:
@copilot 子供の学習進捗を管理するサービスを作成してください。
要件:
- ローカルストレージのみ使用（外部送信なし）
- データ暗号化
- 進捗データの整合性チェック
- 親が設定した学習時間の制限
- バックアップ・復元機能
セキュリティ:
- 個人識別情報は一切保存しない
- データ改ざん防止
- 安全なキー管理
- エラー時の適切なデータ保護
```

## テスト戦略

### Copilotを活用したテスト作成
```dart
// テスト生成の依頼例:
@copilot この数学問題生成クラスの包括的なテストを作成してください。
テスト観点:
- 正常系: 各難易度レベルでの問題生成
- 異常系: 不正な入力値への対応
- 境界値: 最小・最大値での動作
- パフォーマンス: 大量問題生成時の性能
- 子供向け特有: 年齢に適した問題内容の検証
テスト形式:
- Arrange-Act-Assert パターン
- 日本語でのテスト名とコメント
- モックを使用した依存関係の分離
```

## パフォーマンス最適化

### Copilotによる最適化支援
```dart
// パフォーマンス改善の依頼例:
@copilot このウィジェットのbuildメソッドを最適化してください。
現在の問題:
- 不要なrebuildが多発
- スクロール時のジャンク
- メモリ使用量が多い
最適化目標:
- 60FPS維持
- メモリ使用量50%削減
- 初期表示時間1秒以内
制約:
- 既存機能への影響なし
- 子供向けのアニメーション品質維持
- アクセシビリティ機能保持
```

## アクセシビリティ対応

### 必須実装項目
1. **Semantics**: すべてのインタラクティブ要素
2. **コントラスト比**: WCAG AA準拠（4.5:1以上）
3. **フォントサイズ**: システム設定に対応
4. **キーボードナビゲーション**: タブ順序の適切な管理
5. **音声読み上げ**: 分かりやすい読み上げテキスト

### Copilotへの依頼例
```dart
@copilot このボタンウィジェットをアクセシブルにしてください。
要件:
- VoiceOver/TalkBackでの適切な読み上げ
- 十分なコントラスト比（子供向けに配慮）
- 大きなタッチターゲット
- フォーカス時の明確な視覚的表示
- キーボード操作対応
- 色に依存しない情報伝達
```

## セキュリティとプライバシー

### 必須チェック項目
```dart
// セキュリティレビューの依頼:
@copilot このデータ処理コードをセキュリティ観点でレビューしてください。
チェック項目:
- COPPA準拠性
- データ最小化原則
- 暗号化の適切性
- 入力値検証
- エラーハンドリング
- ログ記録の安全性
- 第三者ライブラリの安全性
```

## 開発ワークフロー統合

### Git Commit時のCopilot活用
```bash
# コミットメッセージ生成
@copilot このchangesetに適切なコミットメッセージを生成してください。
# 規約: Conventional Commits形式
# プロジェクト: 子供向け算数学習アプリ
# 言語: 日本語コメント、英語コミットメッセージ
```

### PR作成時のCopilot活用
```markdown
@copilot このPRの説明文を作成してください。
変更内容: [変更の概要]
影響範囲: [影響を受ける機能や画面]
テスト: [実施したテストの内容]
レビュー観点: [特に確認してほしい点]
```

## トラブルシューティング

### 一般的な問題と解決パターン

#### 1. パフォーマンス問題
```dart
@copilot このウィジェットが重い理由を分析し、最適化案を提案してください。
症状: [具体的な症状]
環境: [デバイス情報、Flutter version]
測定結果: [プロファイリング結果があれば]
```

#### 2. レイアウト問題
```dart
@copilot この画面レイアウトが異なる画面サイズで崩れる問題を解決してください。
問題のある画面サイズ: [具体的なサイズや条件]
期待する動作: [どのように表示されるべきか]
制約: [デザインの制約事項]
```

#### 3. 状態管理の問題
```dart
@copilot この状態管理の実装を見直し、より適切なパターンを提案してください。
現在の問題: [状態管理の具体的な問題]
使用している方法: [Provider/Riverpod等]
要件: [状態管理の要件]
```

## 継続的改善

### 定期的な見直し項目
1. **セキュリティ監査**: 月1回
2. **アクセシビリティチェック**: 新機能リリース毎
3. **パフォーマンス測定**: 週1回
4. **コード品質**: PR毎

### Copilotによる改善提案
```dart
@copilot このプロジェクトの全体的なコード品質を評価し、改善提案をしてください。
評価観点:
- 子供向けアプリとしての適切性
- Flutter/Dartのベストプラクティス遵守
- セキュリティとプライバシー
- アクセシビリティ
- パフォーマンス
- 保守性とテスタビリティ
```

## 参考資料

### プロジェクト内ドキュメント
- `.github/copilot-context.md` - プロジェクト全体のコンテキスト
- `.github/instructions/copilot-guidelines.md` - Copilot使用ガイドライン
- `.github/prompts/` - プロンプトテンプレート集
- `docs/` - 技術ドキュメント

### 外部資料
- [Flutter公式ドキュメント](https://docs.flutter.dev/)
- [Material Design 3](https://m3.material.io/)
- [WCAG 2.1アクセシビリティガイドライン](https://www.w3.org/WAI/WCAG21/quickref/)
- [COPPA Rule](https://www.ftc.gov/enforcement/rules/rulemaking-regulatory-reform-proceedings/childrens-online-privacy-protection-rule)

---

**重要**: この指示書は生きたドキュメントです。プロジェクトの進歩に合わせて定期的に更新し、新しいベストプラクティスや学習内容を反映してください。